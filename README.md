# Congestion Control Test Framework - Version 1
This is the first version of the Test Framework, designed to test the functionality of the slow start algorithm using a mock implementation. The framework processes input data from a CSV file and runs the test on the data and exports the outputs in a text file.

![Test Framework](framework_image.png)


# üì¶ Repository Structure: `test_framework`

This framework supports testing and comparing congestion control algorithms like HyStart, BBR, and SEARCH variants. It provides automation for modifying, compiling, and evaluating TCP behavior under various configurations.

---

## üîπ `framework/` ‚Äì Test Framework for Linux-based Simulations

Organized to automate testing with different TCP source files and alpha tuning values.

- `bin/`: Contains core automation scripts (detailed below).
- `support/`: Helper utilities and test files. If the related CC test file does not exist, we can use test_base.c file to customize it for related CC test.
- `original cc files with labels/`: Stores original congestion control source files that are labeled for each CC test (BBR, HyStart, SEARCH)
---

## üîπ `freebsd_test_framework/` ‚Äì Test Framework for FreeBSD-based Simulations
Module focused on testing NewReno with SEARCH enhancements.

- `bin/`, `support/`: Same structure as `framework/`
- `original cc files with labels/`: Stores original congestion control source files that are labeled for each CC test (cc_newreno_search)

#### ‚ö†Ô∏è FreeBSD Header File Requirement
In FreeBSD, each congestion control (CC) algorithm has an associated header (`.h`) file.  
Before compiling, make sure to **copy the corresponding `.h` file from the kernel source** into the `test_dir/`.

**Example:**
```bash
cp /usr/src/sys/netinet/cc/cc_newreno_search.h test_dir/
```
---

## üß™ Core Utility Scripts (`bin/`)

These Python scripts automate preparation, simulation execution, and source extraction.

---
### üìÑ `ss_extract.py`

**Purpose**:  
Generates testable simulation modules from kernel congestion control source files.

**Functionality**:
- Parses the `.c` file to extract labeled parts:
  - TCP struct fields accessed (e.g., `tcp_sk(sk)->field`)
  - Relevant functions, macros, and code blocks

**Produces the following files for standalone testing**:
- `tcp.h`
- `<keyword>_module.c`
- `<keyword>_defs.h`
- `Makefile`

**Usage**:
```bash
python3 ss_extract.py -f tcp_search.c -k SEARCH
```

### üìÑ `ss_setup.py`
**Purpose**:  
Prepares the test environment by copying support and test files into `test_dir/`.

**Functionality**:
- Copies `cc_helper_function.h` and `test_<keyword>.c` into `test_dir/`
- Falls back to using `test_base.c` if `test_<keyword>.c` does not exist

**Usage**:
```bash
python3 ss_setup.py -k SEARCH
```
#### ‚ö†Ô∏è Kernel-Version-Specific Test Files
For some algorithms, the test file depends on the kernel version. Check the `support/` folder to find the correct `test_<keyword>.c` file that matches your source file.  
For example, the HyStart algorithm has separate source files for different kernels (`tcp_cubic_hystart_kern5_10.c` and `tcp_cubic_hystart_kern6_13.c`), with corresponding test files `test_hystart_kern5_10.c` and `test_hystart_kern6_13.c` in the `support/` folder.

**Example:**
```bash
python3 ss_setup.py -k hystart_kern5_10
```

### üìÑ Make file
Purpose:
Compiles the test simulation files generated by ss_extract.py.

**Usage**:
```bash
cd test_dir
make
```

### üìÑ `ss_run.py`

**Purpose**:  
Runs the compiled test binary (`test_<keyword>`) on all `.csv` trace files in the input folder.

**Functionality**:
- Verifies that the binary `test_<keyword>` exists in `test_dir/`
- For each input `.csv` file:
  - Executes the test binary
  - Redirects the output to a `.txt` file in the output folder

**Usage**:
```bash
python3 ss_run.py -f test_directory -k SEARCH -i input_path -o output_path
```
---